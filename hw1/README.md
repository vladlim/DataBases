*Лим Владислав БПИ225 Задание 1*


**Задание:**

Вам поручили разработать базу данных для управления заказами в онлайн-

сервисе доставки еды. Система должна обрабатывать создание, изменение

и управление статусом заказов, включая выбор блюд, оплату и доставку.


• Определите роли пользователей и действия для каждой роли.

• Определите объекты, в которых будут храниться данные.

• Определите связи между объектами для хранения данных.

• Нарисуйте схему объектной модели (используя любые обозначения,

которые вам удобны). Объекты и связи на предыдущих шагах можно сразу

обозначать в виде итоговой схемы.


**Решение:**

Я определил объекты: User, Order, Payment, OrderItem, Dish, Delivery, Category

***User:***

User - пользователь, у которого есть
- user_id       (первичный ключ, идентификатор пользователя)
- name          (строка вида "Имя Фамилия")
- role          (может быть только 'client' или 'courier')


***Order:***

Order - заказ, который имеет поля
- order_id      (первичный ключ, идентификатор заказа)
- user_id       (вторичный ключ, идентификатор пользователя)
- status        (может быть только 'created', 'preparing', 'inTransit', 'cancelled', 'delivered')
- created_at    (дата и время создания)


***OrderItem:***

OrderItem - позиция заказа, которая имеет поля
- item_id       (первичный ключ, идентификатор позиции заказа)
- order_id      (вторичный ключ, идентификатор заказа)
- dish_id       (вторичный ключ, идентификатор блюда)
- quantity      (количество конкретного блюда в заказе)


***Dish:***

Dish - блюдо, имеет поля
- dish_id       (первичный ключ, идентификатор блюда)
- category_id   (вторичный ключ, идентификатор категории блюда)
- name          (название блюда)
- description   (описание блюда)
- price         (цена блюда)


***Category:***

Category - категория блюд, имеет поля
- category_id   (первичный ключ, идентификатор категории блюда)
- name          (название категории)


***Delivery:***

Delivery - доставка, имеет поля
- delivery_id       (первичный ключ, идентификатор доставки)
- order_id          (вторичный ключ, идентификатор заказа)
- user_id           (идентификатор курьера)
- delivery_status   (может быть только 'pending', 'inTransit', 'delivered')


***Delivery:***

Payment - платеж, имеет поля
- payment_id        (первичный ключ, идентификатор платежа)
- order_id          (вторичный ключ, идентификатор заказа)
- amount            (сумма заказа)
- payment_status    (может быть только 'pending', 'completed', 'cancelled', 'failed')



**Объяснение связей:**
- User <---> Order: *один ко многим, так как один клиент может сделать много заказов*
- User <---> Delivery: *один ко многим, так как один курьер может развозить несколько заказов*
- Delivery <---> Order: *один к одному, так как одна доставка осуществляется в рамках одного заказа*
- Payment <---> Order: *один к одному, так как один платеж за один заказ*
- Order <---> OrderItem: *один ко многим, так как в одном заказе может быть много позиций*
- OrderItem <---> Dish: *многие к одному, так как в разных заказах могут быть одни и те же блюда*
- Dish <---> Category: *многие к одному, так как в одной категории может быть много блюд*

На схеме можно увидеть как они между друг другом связаны.
Стоить обратить внимание, что User напрямую связан с заказом только если его роль - клиент.
Также User напрямую связан с доставкой, только если его роль - курьер.

**Роли для User и их возможности:**
*Клиент (role = 'client')*
Клиент может делать заказы, отменять заказы, оплачивать заказы (или не оплачивать).
Связь клиента с платежом через заказ, так как из заказа мы можем вытащить user_id.
То есть клиент влияет на status в Order и на payment_status в Payment.

*Курьер (role = 'courier')*
Курьер может брать заказы и отвозить заказы, то есть влияет на status в Order